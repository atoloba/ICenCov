% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/icglm.R
\name{icglm}
\alias{icglm}
\title{Generalized Linear Models with an Interval-Censored Covariate}
\usage{
icglm(
  formula,
  family = gaussian,
  data,
  Lin = TRUE,
  Rin = TRUE,
  tolpar = 1e-04,
  tolik = 1e-04,
  maxiter = 50,
  maxsec = maxh * 60^2,
  maxh = 12,
  start = NULL,
  PRINT = 0,
  size = NULL
)
}
\arguments{
\item{formula}{A model formula of the form
\code{y ~ x1 + x2 + ... + ic(zl, zr, "z")}.
The interval-censored covariate is supplied via \code{ic()}, where
\code{zl} and \code{zr} are the left and right endpoints, and the third
argument gives the covariate name used in the linear predictor.
Use \code{Lin} and \code{Rin} to state whether endpoints are included
in the interval (see below).}

\item{family}{A \code{stats::family} object. Supported families are
\code{gaussian()}, \code{Gamma()}, \code{inverse.gaussian()},
\code{binomial()}, and \code{poisson()}.}

\item{Lin, Rin}{Logical scalar or length-\eqn{n} vector indicating whether the
left/right endpoints are included in the interval. Defaults are \code{TRUE} for both.}

\item{tolpar}{Relative change threshold for the parameter vector used as a
stopping rule (default \code{1e-4}).}

\item{tolik}{Relative change threshold for the log-likelihood used as a
stopping rule (default \code{1e-4}).}

\item{maxiter}{Maximum number of GELc iterations (default \code{50}).}

\item{maxsec}{Maximum running time in seconds. By default,
\code{maxsec = maxh * 60^2}.}

\item{maxh}{Maximum running time in hours (default \code{12}).}

\item{start}{Optional numeric vector of length \code{p + 2} giving initial
values for \code{c(beta, gamma, phi)}, where \code{p} is the length of beta.
If \code{NULL}, starting values are taken from
\code{glm(y ~ x1 + x2 + ... + midz)} with \code{midz = 0.5 * (zl + zr)}.}

\item{PRINT}{Integer verbosity flag; \code{0} is silent (default),
\code{1} prints iteration summaries, and \code{2} also compares analytic
and numeric gradients for stability checks.}

\item{size}{Optional parameter for the \code{binomial} family. If \code{NULL}
(default), Bernoulli trials are assumed (\code{size = 1}).}
}
\value{
A list with components:
\describe{
\item{\code{thetaHat}}{Numeric vector of estimated parameters
\eqn{(\hat\beta, \hat\gamma, \hat\phi)}.}
\item{\code{wHat}}{Matrix with the estimated density over the
augmented Turnbull intervals.}
\item{\code{A}}{An \eqn{n \times m} indicator matrix mapping each observed
interval to the \eqn{m} augmented Turnbull intervals.}
\item{\code{vcov}}{Approximate variance–covariance matrix based on the
observed Hessian at \code{(thetaHat, wHat)}}
\item{\code{convergence}}{A list with:
\itemize{
\item{\code{convOPT, mssOPT}}: integer code and message returned by the optimizer.
\item \code{reachmaxi, reachmaxt}: flags for \code{maxiter} or \code{maxtime} were reached.
\item \code{reachtolik}: \code{TRUE} if convergence was achieved in a plateau of the loglikelihood function.
\item \code{iter_vals, iter_reldif}: per-iteration parameter values and relative diffs.
\item \code{start_used}: starting values used.
}
}
\item{\code{call,family}}{further information.}
}
}
\description{
Fits a GLM when one covariate is only known to fall within an interval.
It uses the \strong{GELc} estimator: a semiparametric, likelihood-based approach
built on an augmented version of Turnbull's nonparametric estimator for
interval-censored data.
}
\examples{
## --- Logistic regression -----------------------------------------
data(carotenoids)
caro <- subset(carotenoids, !is.na(diabetes))

fit1 <- icglm(diabetes ~ sex + bmi + ic(zl, zr, "caro"), family = binomial,
  data = caro, Lin = TRUE,
  Rin  = with(caro, zl == zr)
)
summary(fit1)

# Odds ratio (OR) and 95\% CI for 'caro':
i = 4
OR_caro  <- exp(coef(fit1)[i])
CI_caro  <- exp(coef(fit1)[i] + c(-1,1)*qnorm(0.975)*sqrt(vcov(fit1)[i,i]))
cat(sprintf("OR = \%.2f (\%.2f, \%.2f)\n",
    OR_caro, CI_caro[1], CI_caro[2]))


## --- Continuous outcome (Gamma with log link) --------------------------
data(actg359)

fit2 <- icglm(RNA ~ age + ic(zl, zr, "waitime"), family = Gamma("log"),
  data = actg359, Lin = FALSE, Rin = TRUE)
summary(fit2)

# Multiplicative effect of a 3-week increase in 'waitime' on the response scale:
i = 3
mult_wt   <- exp(3 * coef(fit2)[i]) - 1
CI_wt <- exp(3 * coef(fit2)[i] + 3*c(-1,1)*qnorm(0.975)*sqrt(vcov(fit2)[i,i])) - 1
cat(sprintf("OR = \%.1f (\%.1f, \%.1f)\n",
    mult_wt*100, CI_wt[1]*100, CI_wt[2]*100))


}
\references{
Gómez, G., Espinal, A., & Lagakos, S. W. (2003).
Inference for a linear regression model with an interval-censored covariate.
\emph{Statistics in Medicine}, 22(3), 409–425. \doi{10.1002/sim.1326}
}
\seealso{
\code{\link[stats]{glm}}
}
